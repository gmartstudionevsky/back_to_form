# Back to Form (S0)

Минималистичное офлайн‑дружелюбное web‑приложение для фитнеса, питания и прогресса. Интерфейс и документация на русском, ориентировано на iPhone (Safari) с крупными элементами, bottom tabs и быстрыми действиями.

## Миссия и фокус продукта
Back to Form помогает системно работать над собой: планировать питание и тренировки, фиксировать факты, видеть прогресс и укреплять велнес‑привычки. Приложение делает ставку на сценарий «План → Сегодня → Факт», чтобы снизить когнитивную нагрузку и повысить вероятность соблюдения плана.

## Ключевая логика: «План → Сегодня → Факт»
1. **План** — создаёте периоды и наполняете дни: меню, тренировки, требования (вес/талия/фото/лимит сигарет), цели по активности.
2. **Сегодня** — превращается в пульт управления: план отображается сразу, доступны быстрые действия и запуск тренировки.
3. **Факт** — в трекере видно, что было запланировано и что выполнено, с процентом закрытия и сравнениями.

## Основные возможности

### Планирование
- Периоды с календарём и конкретными днями.
- План питания по приёмам пищи (завтрак/обед/ужин/перекус).
- План тренировок и активностей.
- Требования на день (вес, талия, фото, лимит сигарет).
- Цели по активности и шагам.

### Сегодня
- Единый «пульт» для действий дня.
- Быстрые кнопки для отметки факта (съедено/выполнено).
- Запуск тренировки с учётом планов.
- Сводка по прогрессу и оставшимся задачам.

### Факт и прогресс
- Журнал действий по дням (питание, тренировки, вода/напитки).
- Сравнение плана и факта, процент закрытия.
- Отдельные записи движения (кардио/шаги/подъёмы) и тренинга.

### Библиотека контента
- Упражнения и протоколы тренировок.
- Продукты, блюда и рецепты.
- Напитки и порции.
- Теги питания (например, «читмил», «перекус»), нутриентные показатели.

### Приватность и медиа
- Фото/видео упражнений хранятся локально в IndexedDB.
- Экспорт JSON не содержит медиафайлы.

### Экспорт/импорт
- **Экспорт JSON** всех сущностей (кроме медиа).
- **Импорт JSON** с полной заменой данных.
- **CSV summary** с агрегированным отчётом по датам.

## UI/UX‑принципы (как заложено в проекте)
- Интерфейс под мобильные устройства, особенно iPhone.
- Большие tappable‑элементы и логичная навигация через bottom tabs.
- Минимум экранов на сценарий, максимум быстрых действий на «Сегодня».
- Плавные, но лёгкие переходы и bottom sheet для вторичных действий.

## Архитектура и данные

### Хранилища
- **LocalStorage** — основное состояние приложения.
- **IndexedDB** — фото/видео и медиа.
- **PWA** (manifest + service worker) — офлайн‑доступ.

### Миграции данных
Данные версионируются через `schemaVersion`. При несовпадении версии применяется последовательная миграция, чтобы сохранить старые записи и заполнить новые поля значениями по умолчанию.

### Логи (debug)
В проект добавлены минимальные логи состояния хранилищ. Логи включаются автоматически в режиме разработки и опционально через `localStorage`‑флаг:

```js
localStorage.setItem('btf-debug', '1')
```

## Стек
- **TypeScript + React + Vite**
- **TailwindCSS**
- **Zustand** (простое состояние)
- **LocalStorage** + **IndexedDB**
- **PWA**: manifest + service worker

## Запуск локально
```bash
npm install
npm run dev
```

## Сборка
```bash
npm run build
npm run preview
```

## Деплой на GitHub Pages
В репозитории есть workflow `.github/workflows/deploy.yml`, который собирает Vite‑приложение и публикует содержимое `dist`.

1. Проверьте, что в `vite.config.ts` корректный `base` (по умолчанию `'/back_to_form/'`).
2. Пуш в `main` автоматически запускает build + deploy через GitHub Actions.

> Если репозиторий называется иначе, задайте `VITE_BASE_PATH` при сборке:
```bash
VITE_BASE_PATH=/my-repo/ npm run build
```

## Где редактировать словари
Все глобальные сущности хранятся в `src/data/seed.ts`. Добавляйте/правьте:
- упражнения, протоколы, продукты, блюда, правила
- seed‑периоды и планы дней

После первого запуска данные сохраняются в LocalStorage. Чтобы «пересидить» сид, используйте кнопку **Сбросить все данные**.

## Как добавить новый период и меню
1. Откройте вкладку **План**.
2. Создайте период и выберите день.
3. Наполните меню (завтрак/обед/ужин/перекус), тренировки и требования.

## Экспорт / импорт данных
- **Экспорт JSON**: сохраняет все сущности, **кроме фото/видео**.
- **Импорт JSON**: **replace‑all** (полная замена локальных данных).
- **CSV summary**: агрегированный отчёт по датам.

## Фото и приватность
Фото и видео упражнений сохраняются только локально (IndexedDB). При экспорте JSON файлы не включаются.

## Структура проекта
- `src/data/seed.ts` — стартовые данные
- `src/store/useAppStore.ts` — состояние
- `src/storage/` — LocalStorage + IndexedDB
- `src/pages/` — экраны
- `src/components/` — UI‑компоненты
- `src/utils/` — расчёты, даты, логирование
- `public/` — manifest, service worker

## Ограничения и зоны роста
- Приложение не синхронизируется между устройствами (данные локальные).
- Нет серверной авторизации и резервного копирования.
- Экспорт/импорт требует ручного участия пользователя.
- Нужна расширенная аналитика прогресса (графики, корреляции).

## Примечания
- Шрифт: Manrope (максимально близко к Circe).
- Переходы и bottom sheet реализованы минималистично.
